---
title: Dealing with missing values
author: Michael Fuchs
date: '2019-03-18'
slug: dealing-with-missing-values
categories:
  - R
tags:
  - R Markdown
output:
  blogdown::html_page:
    toc: true
    toc_depth: 5
---

# 1 Introduction


In the real world, there is virtually no record that has no missing values. Dealing with missing values can be done differently. In the following several methods will be presented how to deal with them.


# 2 Loading the Libraries and the Data

```{r, eval=F, echo=T}
import pandas as pd
import numpy as np

from sklearn.impute import SimpleImputer
from sklearn.pipeline import Pipeline

from sklearn.impute import KNNImputer

from sklearn.model_selection import train_test_split
import pickle as pk
import random
```

```{r, eval=F, echo=T}
df = pd.DataFrame({'Name': ['Anton', 'Moni', np.NaN, 'Renate', 'Justus'],
                   'Age': [32,22,62,np.NaN,18],
                   'Salary': [np.NaN, np.NaN,4500,2500,3800],
                   'Job': ['Student', np.NaN, 'Manager', 'Teacher', 'Student']})
df
```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p1.png)


# 3 Checking for missing values


```{r, eval=F, echo=T}
df.isnull().sum()
```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p2.png)


```{r, eval=F, echo=T}
def mv_overview_func(df):
    '''
    Gives an overview of the total number and percentage of missing values in a data set
    
    Args:
        df (DataFrame): Dataframe to which the function is to be applied
        
    Returns:
        Overview of the total number and percentage of missing values
    '''
    # Total missing values
    mis_val = df.isnull().sum()
    # Percentage of missing values
    mis_val_percent = 100 * df.isnull().sum() / len(df)
    # Data Types
    data_types = df.dtypes
    # Make a table with the results
    mis_val_table = pd.concat([mis_val, mis_val_percent, data_types], axis=1)
    # Rename the columns
    mis_val_table_ren_columns = mis_val_table.rename(
    columns = {0 : 'Missing Values', 1 : '% of Total Values', 2 : 'Data Type'})
    # Sort the table by percentage of missing descending
    mis_val_table_ren_columns = mis_val_table_ren_columns[
        mis_val_table_ren_columns.iloc[:,1] != 0].sort_values(
        '% of Total Values', ascending=False).round(1)
    # Print some summary information
    print ("Your selected dataframe has " + str(df.shape[1]) + " columns.\n"      
            "There are " + str(mis_val_table_ren_columns.shape[0]) +
            " columns that have missing values.")
    # Return the dataframe with missing information
    return mis_val_table_ren_columns
```

```{r, eval=F, echo=T}
mv_overview_func(df)
```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p3.png)

# 4 Droping of Missing Values


```{r, eval=F, echo=T}
df_drop = df.copy()
df_drop
```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p4.png)


All rows with minimum one NaN will be dropped:

```{r, eval=F, echo=T}
df_drop.dropna()
```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p5.png)


All rows from the defined columns with a NaN will be dropped:


```{r, eval=F, echo=T}
df_drop.dropna(subset=['Name', 'Age'])
```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p6.png)


# 5 Imputations

## 5.1 for **NUMERIC** Features


```{r, eval=F, echo=T}
df_replace_1 = df.copy()
df_replace_1
```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p7.png)


Missing values from only one column (here 'Name') are replaced:


```{r, eval=F, echo=T}
df_replace_1['Name'] = df_replace_1['Name'].fillna(0)
df_replace_1
```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p8.png)


Missing values from the complete dataset will be replaced:

```{r, eval=F, echo=T}
df_replace_1.fillna(0, inplace=True)
df_replace_1
```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p9.png)


Does that make sense? Probably not. So let's look at imputations that follow a certain logic.


### 5.1.2 Replace np.NaN with MEAN












```{r, eval=F, echo=T}

```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p.png)































```{r, eval=F, echo=T}

```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p.png)










































```{r, eval=F, echo=T}

```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p.png)



























```{r, eval=F, echo=T}

```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p.png)































```{r, eval=F, echo=T}

```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p.png)

























```{r, eval=F, echo=T}

```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p.png)

























```{r, eval=F, echo=T}

```

![](/post/2019-03-18-dealing-with-missing-values_files/p4p.png)






