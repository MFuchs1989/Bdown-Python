---
title: Data Wrangling
author: Michael Fuchs
date: '2019-03-03'
slug: data-wrangling
categories:
  - R
tags:
  - R Markdown
  
output:
  blogdown::html_page:
    toc: true
    toc_depth: 5
---


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">1 Introduction</a></li>
<li><a href="#loading-the-libraries-and-the-data" id="toc-loading-the-libraries-and-the-data">2 Loading the libraries and the data</a></li>
<li><a href="#overview-of-the-data" id="toc-overview-of-the-data">3 Overview of the data</a></li>
<li><a href="#get-some-statistics" id="toc-get-some-statistics">4 Get some statistics</a></li>
<li><a href="#select-data" id="toc-select-data">5 Select data</a>
<ul>
<li><a href="#easy-selection" id="toc-easy-selection">5.1 Easy Selection</a></li>
<li><a href="#conditional-selection" id="toc-conditional-selection">5.2 Conditional Selection</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>1 Introduction</h1>
<p>Never stop learning !</p>
<p>The entry into the field of data science with <a href="https://michael-fuchs.netlify.com/">“R / R-Studio”</a> was a smart matter. Now it’s time and for each Data Scientist advisable to learn another scripting language.</p>
<p>Let’s start with Python!</p>
<p>For this post the dataset <em>flight</em> from the statistic platform <a href="https://www.kaggle.com">“Kaggle”</a> was used. You can download it from my <a href="https://github.com/MFuchs1989/Datasets-and-Miscellaneous/tree/main/datasets">GitHub Repository</a>.</p>
</div>
<div id="loading-the-libraries-and-the-data" class="section level1">
<h1>2 Loading the libraries and the data</h1>
<pre class="r"><code>import pandas as pd
import numpy as np</code></pre>
<pre class="r"><code>flight = pd.read_csv(&quot;flight.csv&quot;)</code></pre>
</div>
<div id="overview-of-the-data" class="section level1">
<h1>3 Overview of the data</h1>
<p>With the following commands it is possible to get a quick overview of his available data.</p>
<pre class="r"><code>flight.head()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p1.png" /></p>
<pre class="r"><code>flight.tail()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p2.png" /></p>
<pre class="r"><code>flight.shape</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p3.png" /></p>
<pre class="r"><code>flight.columns</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p4.png" /></p>
<pre class="r"><code>flight[&#39;Origin_Airport&#39;].value_counts().head().T</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p5.png" /></p>
<pre class="r"><code>flight.dtypes.head()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p6.png" /></p>
<p>We can also output the unique values of a column.</p>
<pre class="r"><code>#List unique values in the flight[&#39;Origin_Airport&#39;] column
flight.Origin_Airport.unique()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p7.png" /></p>
<p>Now let’s take a look at the unique values of several columns. For this purpose, I will select 4 categorical columns from the data set as an example:</p>
<pre class="r"><code>flight_subset = flight[[&#39;UniqueCarrier&#39;,&#39;Tai_lNum&#39;,&#39;Origin_Airport&#39;,&#39;Origin_City_Name&#39;]]
flight_subset</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p8.png" /></p>
<p>Now I can use a for loop to display the number of contained labels:</p>
<pre class="r"><code>for feature in flight_subset.columns[:]:
    print(feature, &#39;:&#39;, len(flight_subset[feature].unique()), &#39;labels&#39;)</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p9.png" /></p>
</div>
<div id="get-some-statistics" class="section level1">
<h1>4 Get some statistics</h1>
<pre class="r"><code>flight.describe()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p10.png" /></p>
<pre class="r"><code>flight[&#39;Dep_Delay&#39;].agg([&#39;mean&#39;, &#39;median&#39;, &#39;std&#39;, &#39;min&#39;, &#39;max&#39;]).reset_index()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p11.png" /></p>
<pre class="r"><code>flight[[&#39;Origin_Airport&#39;, &#39;Departure_Time&#39;, &#39;Dep_Delay&#39;, &#39;Carrier_Delay&#39;]].groupby(&#39;Origin_Airport&#39;).mean().head()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p12.png" /></p>
</div>
<div id="select-data" class="section level1">
<h1>5 Select data</h1>
<div id="easy-selection" class="section level2">
<h2>5.1 Easy Selection</h2>
<pre class="r"><code>flight[[&#39;Year&#39;]].head()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p13.png" /></p>
<pre class="r"><code>flight[[&#39;Year&#39;, &#39;WeatherDelay&#39;]].head()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p14.png" /></p>
<pre class="r"><code># Select specific rows
flight[1:4]</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p15.png" /></p>
<pre class="r"><code># Select specific rows &amp; columns
flight.loc[1:4, [&#39;Year&#39;, &#39;WeatherDelay&#39;, &#39;Flight_Date&#39;]]</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p16.png" /></p>
<pre class="r"><code># Select all columns from Col_X to Col_Y
flight.loc[:,&#39;Year&#39;:&#39;DayOfWeek&#39;].head()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p17.png" /></p>
<pre class="r"><code># Select all columns from Col_X to Col_Y and Col_Z
flight.loc[:,&#39;Year&#39;:&#39;DayOfWeek&#39;].join(flight.loc[:,&#39;Tai_lNum&#39;]).head()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p18.png" /></p>
<pre class="r"><code># Select all columns from Col_X to Col_Y and from Col_Z to Col_*
flight.loc[:,&#39;Year&#39;:&#39;DayOfWeek&#39;].join(flight.loc[:,&#39;Tai_lNum&#39;:&#39;Origin_Airport&#39;]).head()</code></pre>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p19.png" /></p>
</div>
<div id="conditional-selection" class="section level2">
<h2>5.2 Conditional Selection</h2>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p.png" /></p>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p.png" /></p>
<p><img src="/post/2019-03-03-data-wrangling_files/p1p.png" /></p>
</div>
</div>
