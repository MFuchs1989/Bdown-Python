---
title: Time Series Analysis - Smoothing Methods
author: Michael Fuchs
date: '2020-10-23'
slug: time-series-analysis-smoothing-methods
categories:
  - R
tags:
  - R Markdown
output:
  blogdown::html_page:
    toc: true
    toc_depth: 5
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>

<div id="TOC">
<ul>
<li><a href="#introduction">1 Introduction</a></li>
<li><a href="#import-libraries-and-data">2 Import libraries and data</a></li>
<li><a href="#definition-of-required-functions">3 Definition of required functions</a></li>
<li><a href="#xx-conclusion">XX Conclusion</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>1 Introduction</h1>
<p>Now that I have given an <a href="https://michael-fuchs-python.netlify.app/2020/10/19/time-series-analysis-working-with-dates-and-times/">introduction to the topic of time series analysis</a>, we come to the first models with which we can make predictions for time series: Smooting Methods</p>
<p>The smoothing technique is a family of time-series forecasting algorithms, which utilizes the weighted averages of a previous observation to predict or forecast a new value.
This technique is more efficient when time-series data is moving slowly over time. It harmonizes errors, trends and seasonal components into computing smoothing parameters.</p>
<p>In the following, we will look at three different smoothing methods:</p>
<ul>
<li>Simple Exponential Smoothing</li>
<li>Double Exponential Smoothing</li>
<li>Triple Exponential Smoothing</li>
</ul>
<p>For this post the dataset <em>FB</em> from the statistic platform <a href="https://www.kaggle.com">“Kaggle”</a> was used. You can download it from my <a href="https://github.com/MFuchs1989/Bdown-Python/tree/master/datasets/Time%20Series%20Analysis">“GitHub Repository”</a>.</p>
</div>
<div id="import-libraries-and-data" class="section level1">
<h1>2 Import libraries and data</h1>
<pre class="r"><code>import pandas as pd
import numpy as np
from sklearn import metrics

import matplotlib.pyplot as plt
%matplotlib inline

from sklearn.model_selection import ParameterGrid

from statsmodels.tsa.api import SimpleExpSmoothing
from statsmodels.tsa.api import Holt
from statsmodels.tsa.api import ExponentialSmoothing</code></pre>
<pre class="r"><code>df = pd.read_csv(&#39;FB.csv&#39;)
df.head()</code></pre>
<p><img src="/post/2020-10-23-time-series-analysis-smoothing-methods_files/p95p1.png" /></p>
<p>Let’s generate a training part and a test part (the last 30 values).
We will focus our analysis on the ‘Close’ column. This column contains the last close of the Facebook share at the end of the respective day.</p>
<pre class="r"><code>X = df[&#39;Close&#39;]

testX = X.iloc[-30:]
trainX = X.iloc[:-30]</code></pre>
</div>
<div id="definition-of-required-functions" class="section level1">
<h1>3 Definition of required functions</h1>
<p>For the evaluation of the following models I create a function to calculate the mean absolute percentage error and another function that outputs this metric and others for evaluation.</p>
<pre class="r"><code>def mean_absolute_percentage_error(y_true, y_pred):
    &#39;&#39;&#39;
    Calculate the mean absolute percentage error as a metric for evaluation
    
    Args:
        y_true (float64): Y values for the dependent variable (test part), numpy array of floats 
        y_pred (float64): Predicted values for the dependen variable (test parrt), numpy array of floats
    
    Returns:
        Mean absolute percentage error 
    &#39;&#39;&#39;    
    y_true, y_pred = np.array(y_true), np.array(y_pred)
    return np.mean(np.abs((y_true - y_pred) / y_true)) * 100</code></pre>
<pre class="r"><code>def timeseries_evaluation_metrics_func(y_true, y_pred):
    &#39;&#39;&#39;
    Calculate the following evaluation metrics:
        - MSE
        - MAE
        - RMSE
        - MAPE
        - R²
    
    Args:
        y_true (float64): Y values for the dependent variable (test part), numpy array of floats 
        y_pred (float64): Predicted values for the dependen variable (test parrt), numpy array of floats
    
    Returns:
        MSE, MAE, RMSE, MAPE and R² 
    &#39;&#39;&#39;    
    print(&#39;Evaluation metric results: &#39;)
    print(f&#39;MSE is : {metrics.mean_squared_error(y_true, y_pred)}&#39;)
    print(f&#39;MAE is : {metrics.mean_absolute_error(y_true, y_pred)}&#39;)
    print(f&#39;RMSE is : {np.sqrt(metrics.mean_squared_error(y_true, y_pred))}&#39;)
    print(f&#39;MAPE is : {mean_absolute_percentage_error(y_true, y_pred)}&#39;)
    print(f&#39;R2 is : {metrics.r2_score(y_true, y_pred)}&#39;,end=&#39;\n\n&#39;)</code></pre>
<p><img src="/post/2020-10-23-time-series-analysis-smoothing-methods_files/p95p.png" /></p>
</div>
<div id="xx-conclusion" class="section level1">
<h1>XX Conclusion</h1>
<p><strong>References</strong></p>
</div>
