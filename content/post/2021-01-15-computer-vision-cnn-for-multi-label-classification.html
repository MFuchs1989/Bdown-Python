---
title: Computer Vision - CNN for Multi-Label Classification
author: Michael Fuchs
date: '2021-01-15'
slug: computer-vision-cnn-for-multi-label-classification
categories:
  - R
tags:
  - R Markdown
output:
  blogdown::html_page:
    toc: true
    toc_depth: 5
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>

<div id="TOC">
<ul>
<li><a href="#introduction">1 Introduction</a></li>
<li><a href="#import-the-libraries">2 Import the libraries</a></li>
<li><a href="#data-pre-processing">3 Data pre-processing</a>
<ul>
<li><a href="#train-validation-test-split">3.1 Train-Validation-Test Split</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>1 Introduction</h1>
<p>In my last post, we saw how Convolutional Neural Networks can be used to make <a href="https://michael-fuchs-python.netlify.app/2021/01/08/computer-vision-convolutional-neural-network/">binary classifications of image data</a>. Of course you also have the possibility to do multi-label classifications. This is what I will introduce in this post.</p>
<p><img src="/post/2021-01-15-computer-vision-cnn-for-multi-label-classification_files/p105s1.png" /></p>
<p>Most of the steps are the same as for binary classification. If new ones are added, I will of course explain them in this post.</p>
<p>For this post I used the images from the <em>Animal Faces</em> dataset from the statistics platform <a href="https://www.kaggle.com/andrewmvd/animal-faces">“Kaggle”</a>. You can download the used data from my <a href="https://github.com/MFuchs1989/Datasets-and-Miscellaneous/tree/main/datasets/Computer%20Vision/CNN%20for%20Multi%20Label%20Classification">“GitHub Repository”</a>.</p>
</div>
<div id="import-the-libraries" class="section level1">
<h1>2 Import the libraries</h1>
<pre class="r"><code>from preprocessing_multi_CNN import Train_Validation_Test_Split

import numpy as np
import pandas as pd

import pickle as pk

import os
import shutil

import cv2 
import matplotlib.pyplot as plt
%matplotlib inline 

from keras import layers
from keras import models
from keras.callbacks import EarlyStopping, ModelCheckpoint

from keras.preprocessing.image import ImageDataGenerator
from keras.models import load_model</code></pre>
</div>
<div id="data-pre-processing" class="section level1">
<h1>3 Data pre-processing</h1>
<div id="train-validation-test-split" class="section level2">
<h2>3.1 Train-Validation-Test Split</h2>
<p>This step is already known from the <a href="https://michael-fuchs-python.netlify.app/2021/01/08/computer-vision-convolutional-neural-network/#train-validation-test-split">Convolutional Neural Network post</a>. Read there again if you have questions about it.</p>
<p>Again, I have written the necessary preparation steps as described in the <a href="https://michael-fuchs-python.netlify.app/2021/01/01/computer-vision-automate-the-boring-stuff/#train-validation-test-split">Automate The Boring Stuff post</a> into a separate .py file.</p>
<p>I have chosen the percentage distribution as follows:</p>
<ul>
<li>Trainings Part: 60%</li>
<li>Validation Part: 20%</li>
<li>Testing Part: 20%</li>
</ul>
<p>You can also download the .py file mentioned before from my <a href="https://github.com/MFuchs1989/Datasets-and-Miscellaneous/tree/main/datasets/Computer%20Vision/CNN%20for%20Multi%20Label%20Classification">“GitHub Repository”</a>.</p>
<p>Place this file (preprocessing_multi_CNN.py) next to the folders <em>cats</em>, <em>dogs</em> and <em>wilds</em> and start your Jupyter notebook from here.</p>
<pre class="r"><code>c_train, d_train, w_train, \
c_val, d_val, w_val, \
c_test, d_test, w_test = Train_Validation_Test_Split(&#39;cats&#39;, &#39;dogs&#39;, &#39;wilds&#39;)</code></pre>
<p><img src="/post/2021-01-15-computer-vision-cnn-for-multi-label-classification_files/p105p1.png" /></p>
<p><img src="/post/2021-01-15-computer-vision-cnn-for-multi-label-classification_files/p105p.png" /></p>
</div>
</div>
