---
title: Computer Vision - CNN for Multi-Label Classification
author: Michael Fuchs
date: '2021-01-15'
slug: computer-vision-cnn-for-multi-label-classification
categories:
  - R
tags:
  - R Markdown
output:
  blogdown::html_page:
    toc: true
    toc_depth: 5
---


# 1 Introduction


In my last post, we saw how Convolutional Neural Networks can be used to make [binary classifications of image data](https://michael-fuchs-python.netlify.app/2021/01/08/computer-vision-convolutional-neural-network/). Of course you also have the possibility to do multi-label classifications. This is what I will introduce in this post.


![](/post/2021-01-15-computer-vision-cnn-for-multi-label-classification_files/p105s1.png)

Most of the steps are the same as for binary classification. If new ones are added, I will of course explain them in this post.


For this post I used the images from the *Animal Faces* dataset from the statistics platform ["Kaggle"](https://www.kaggle.com/andrewmvd/animal-faces). You can download the used data from my ["GitHub Repository"](https://github.com/MFuchs1989/Datasets-and-Miscellaneous/tree/main/datasets/Computer%20Vision/CNN%20for%20Multi%20Label%20Classification). 



# 2 Import the libraries

```{r, eval=F, echo=T}
from preprocessing_multi_CNN import Train_Validation_Test_Split

import numpy as np
import pandas as pd

import pickle as pk

import os
import shutil

import cv2 
import matplotlib.pyplot as plt
%matplotlib inline 

from keras import layers
from keras import models
from keras.callbacks import EarlyStopping, ModelCheckpoint

from keras.preprocessing.image import ImageDataGenerator
from keras.models import load_model
```




# 3 Data pre-processing

## 3.1 Train-Validation-Test Split

This step is already known from the [Convolutional Neural Network post](https://michael-fuchs-python.netlify.app/2021/01/08/computer-vision-convolutional-neural-network/#train-validation-test-split). Read there again if you have questions about it. 

Again, I have written the necessary preparation steps as described in the [Automate The Boring Stuff post](https://michael-fuchs-python.netlify.app/2021/01/01/computer-vision-automate-the-boring-stuff/#train-validation-test-split) into a separate .py file. 


I have chosen the percentage distribution as follows:

+ Trainings Part: 60%
+ Validation Part: 20%
+ Testing Part: 20%

You can also download the .py file mentioned before from my ["GitHub Repository"](https://github.com/MFuchs1989/Datasets-and-Miscellaneous/tree/main/datasets/Computer%20Vision/CNN%20for%20Multi%20Label%20Classification). 

Place this file (preprocessing_multi_CNN.py) next to the folders *cats*, *dogs* and *wilds* and start your Jupyter notebook from here.



```{r, eval=F, echo=T}
c_train, d_train, w_train, \
c_val, d_val, w_val, \
c_test, d_test, w_test = Train_Validation_Test_Split('cats', 'dogs', 'wilds')
```

![](/post/2021-01-15-computer-vision-cnn-for-multi-label-classification_files/p105p1.png)













```{r, eval=F, echo=T}

```

![](/post/2021-01-15-computer-vision-cnn-for-multi-label-classification_files/p105p.png)





